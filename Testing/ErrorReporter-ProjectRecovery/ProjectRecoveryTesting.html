<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Project Recovery Testing</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Live Data Testing" href="../LiveData/LiveDataTests.html" />
    <link rel="prev" title="Error Reporter Testing" href="ErrorReporterTesting.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>master</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="../../index.html">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">User Documentation</a></li>
                <li><a href="http://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
<div class="related" role="navigation" aria-label="related navigation">
  <h3>Navigation</h3>
  <ul>
    <li class="nav-item nav-item-0"><a href="../../index.html">Documentation</a> &#187;</li>
    
    <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Testing</a> &#187;</li>
    
    
    
    
    <li class="nav-item nav-item-this"><a href="">Project Recovery Testing</a></li>
    
    
  </ul>
</div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="project-recovery-testing">
<span id="id1"></span><h1>Project Recovery Testing<a class="headerlink" href="#project-recovery-testing" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#project-recovery-test" id="id2">Project Recovery test</a></p></li>
</ul>
</nav>
<section id="project-recovery-test">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Project Recovery test</a><a class="headerlink" href="#project-recovery-test" title="Permalink to this heading">¶</a></h2>
<p><em>Preparation</em></p>
<ul class="simple">
<li><p>Before running these tests, open <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">&gt;</span> <span class="pre">Settings</span> <span class="pre">&gt;</span> <span class="pre">General</span> <span class="pre">&gt;</span> <span class="pre">Project</span> <span class="pre">Recovery</span></code> and set <code class="docutils literal notranslate"><span class="pre">Enabled</span></code> to true,
<code class="docutils literal notranslate"><span class="pre">Time</span> <span class="pre">between</span> <span class="pre">recovery</span> <span class="pre">checkpoints</span></code> to 2 seconds and <code class="docutils literal notranslate"><span class="pre">Total</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">checkpoints</span></code> to 5.
Further instructions can be found on the
<a class="reference external" href="https://docs.mantidproject.org/nightly/concepts/ProjectRecovery.html#project-recovery" title="(in MantidProject v6.5)"><span class="xref std std-ref">Project Recovery concepts page</span></a>.</p></li>
<li><p>Download the ISIS sample dataset from the <a class="reference external" href="http://download.mantidproject.org/">Downloads page</a>.</p></li>
<li><p><cite>TOPAZ_3132_event.nxs</cite> - available in <code class="docutils literal notranslate"><span class="pre">/Testing/Data/SystemTest/</span></code>, get this by building the <cite>SystemTestData</cite> target.
It should be in <code class="docutils literal notranslate"><span class="pre">ExternalData/Testing/Data/SystemTest/</span></code></p></li>
<li><p>The files <cite>INTER000*</cite> are in the ISIS sample data</p></li>
<li><p>Include the directory containing the test files in your Managed User Directories.</p></li>
<li><p>Set up a save directory to store output for comparison, referred to as <code class="docutils literal notranslate"><span class="pre">testing_directory</span></code> below</p></li>
<li><p>Note that if you have error reporting enabled, simply select <code class="docutils literal notranslate"><span class="pre">Do</span> <span class="pre">not</span> <span class="pre">share</span> <span class="pre">information</span></code> in the Error Reporter dialog</p></li>
</ul>
<p><strong>Time required 15 - 30  minutes</strong></p>
<hr class="docutils" />
<ol class="arabic simple">
<li><p>Simple tests</p></li>
</ol>
<ul class="simple">
<li><p>Open MantidWorkbench</p></li>
<li><p>Right-click in the Messages Box and set <cite>Log level</cite> to <cite>Debug</cite></p></li>
<li><p>Currently, all that should be printed is <cite>Nothing to save</cite></p></li>
<li><p>Run the following command to create a simple workspace:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">DataY</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">DataE</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">NSpec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;NewWorkspace&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The Messages box should now be printing <cite>Project Recovery: Saving started</cite> and <cite>Project Recovery: Saving finished</cite> on
alternate lines</p></li>
<li><p>Now run this script:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Load</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;INTER00013464.nxs&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;INTER1&#39;</span><span class="p">)</span>
<span class="n">Load</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;INTER00013469.nxs&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;INTER2&#39;</span><span class="p">)</span>
<span class="n">Load</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s1">&#39;INTER00013469.nxs&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;INTER3&#39;</span><span class="p">)</span>
<span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;INTER2&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename2&#39;</span><span class="p">)</span>
<span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;INTER1&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename1&#39;</span><span class="p">)</span>
<span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;INTER3&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename3&#39;</span><span class="p">)</span>
<span class="n">Fit</span><span class="p">(</span><span class="n">Function</span><span class="o">=</span><span class="s1">&#39;name=DynamicKuboToyabe,BinWidth=0.05,&#39;</span> <span class="s1">&#39;Asym=5.83382,Delta=5.63288,Field=447.873,Nu=8.53636e-09&#39;</span><span class="p">,</span> <span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename1&#39;</span><span class="p">,</span> <span class="n">IgnoreInvalidData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s1">&#39;Rename1_fit&#39;</span><span class="p">,</span> <span class="n">OutputCompositeMembers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ConvolveMembers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Fit</span><span class="p">(</span><span class="n">Function</span><span class="o">=</span><span class="s1">&#39;name=ExpDecayMuon,A=4306.05,Lambda=0.458289&#39;</span><span class="p">,</span> <span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename2&#39;</span><span class="p">,</span> <span class="n">IgnoreInvalidData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s1">&#39;Rename2_fit&#39;</span><span class="p">,</span> <span class="n">OutputCompositeMembers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ConvolveMembers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Fit</span><span class="p">(</span><span class="n">Function</span><span class="o">=</span><span class="s1">&#39;name=Abragam,A=-500.565,Omega=944.105,Phi=-2.97876,Sigma=230.906,Tau=5.54415e+06&#39;</span><span class="p">,</span> <span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename1_fit_Workspace&#39;</span><span class="p">,</span> <span class="n">CreateOutput</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s1">&#39;Rename1_fit_Workspace_1&#39;</span><span class="p">,</span> <span class="n">CalcErrors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Fit</span><span class="p">(</span><span class="n">Function</span><span class="o">=</span><span class="s1">&#39;name=Abragam,A=343210,Omega=-91853.1,Phi=-1.51509,Sigma=11920.5,Tau=2.80013e+13&#39;</span><span class="p">,</span> <span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename2_fit_Workspace&#39;</span><span class="p">,</span> <span class="n">CreateOutput</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s1">&#39;Rename2_fit_Workspace_1&#39;</span><span class="p">,</span> <span class="n">CalcErrors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">GroupWorkspaces</span><span class="p">(</span><span class="n">InputWorkspaces</span><span class="o">=</span><span class="s1">&#39;Rename1_fit_Workspace_1_Workspace,Rename2_fit_Workspace_1_Workspace&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename3_fit_Workspaces&#39;</span><span class="p">)</span>
<span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename1_fit_Workspace_1_Workspace&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Sequential1&#39;</span><span class="p">)</span>
<span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename2_fit_Workspace_1_Workspace&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Sequential2&#39;</span><span class="p">)</span>
<span class="n">Fit</span><span class="p">(</span><span class="n">Function</span><span class="o">=</span><span class="s1">&#39;name=ExpDecayMuon,A=4306.05,Lambda=0.458289&#39;</span><span class="p">,</span> <span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename3&#39;</span><span class="p">,</span> <span class="n">IgnoreInvalidData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s1">&#39;Rename3_fit&#39;</span><span class="p">,</span> <span class="n">OutputCompositeMembers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ConvolveMembers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Fit</span><span class="p">(</span><span class="n">Function</span><span class="o">=</span><span class="s1">&#39;name=ExpDecayMuon,A=4306.05,Lambda=0.458289&#39;</span><span class="p">,</span> <span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename2_fit_Workspace&#39;</span><span class="p">,</span> <span class="n">CreateOutput</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s1">&#39;Rename2_fit_Workspace_1&#39;</span><span class="p">,</span> <span class="n">CalcErrors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Fit</span><span class="p">(</span><span class="n">Function</span><span class="o">=</span><span class="s1">&#39;name=ExpDecayMuon,A=4306.05,Lambda=0.458289&#39;</span><span class="p">,</span> <span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename3_fit_Workspace&#39;</span><span class="p">,</span> <span class="n">CreateOutput</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s1">&#39;Rename3_fit_Workspace_1&#39;</span><span class="p">,</span> <span class="n">CalcErrors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">GroupWorkspaces</span><span class="p">(</span><span class="n">InputWorkspaces</span><span class="o">=</span><span class="s1">&#39;Rename2_fit_Workspace_1_Workspace,Rename3_fit_Workspace_1_Workspace&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename3_fit_Workspaces&#39;</span><span class="p">)</span>
<span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename3_fit_Workspace_1_Workspace&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Sequential3&#39;</span><span class="p">)</span>
<span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename2_fit_Workspace_1_Workspace&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Sequential4&#39;</span><span class="p">)</span>
<span class="n">Fit</span><span class="p">(</span><span class="n">Function</span><span class="o">=</span><span class="s1">&#39;name=ExpDecayMuon,A=4306.05,Lambda=0.458289&#39;</span><span class="p">,</span> <span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename3_fit_Workspace&#39;</span><span class="p">,</span> <span class="n">CreateOutput</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s1">&#39;Rename3_fit_Workspace_1&#39;</span><span class="p">,</span> <span class="n">CalcErrors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Fit</span><span class="p">(</span><span class="n">Function</span><span class="o">=</span><span class="s1">&#39;name=ExpDecayMuon,A=4306.05,Lambda=0.458289&#39;</span><span class="p">,</span> <span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename1_fit_Workspace&#39;</span><span class="p">,</span> <span class="n">CreateOutput</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s1">&#39;Rename1_fit_Workspace_1&#39;</span><span class="p">,</span> <span class="n">CalcErrors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">GroupWorkspaces</span><span class="p">(</span><span class="n">InputWorkspaces</span><span class="o">=</span><span class="s1">&#39;Rename3_fit_Workspace_1_Workspace,Rename1_fit_Workspace_1_Workspace&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename3_fit_Workspaces&#39;</span><span class="p">)</span>
<span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename3_fit_Workspace_1_Workspace&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Sequential5&#39;</span><span class="p">)</span>
<span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename1_fit_Workspace_1_Workspace&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Sequential6&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Wait a few seconds, then provoke a crash by executing the <cite>Segfault</cite> algorithm with <code class="docutils literal notranslate"><span class="pre">DryRun</span></code> set to False.</p></li>
<li><p>Restart MantidWorkbench</p></li>
<li><p>You should be presented with the Project Recovery dialog</p></li>
<li><p>Choose <cite>Yes</cite></p></li>
<li><p>This should re-populate your workspace dialog and pop up a recovery script in the script window</p></li>
</ul>
<hr class="docutils" />
<ol class="arabic simple" start="2">
<li><p>Testing many workspaces</p></li>
</ol>
<ul class="simple">
<li><p>Open up MantidWorkbench</p></li>
<li><p>Run the following script:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">testing_directory</span><span class="o">=&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">test</span><span class="o">&gt;</span>
<span class="c1"># &lt;path-to-test&gt; is the location of a directory for saving workspaces for comparison later</span>
<span class="c1"># e.g. C:\Users\abc1234\Desktop\test_proj_rec\</span>
<span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">DataY</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">DataE</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">NSpec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;0Rebinned&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">Rebinned&#39;</span><span class="o">%</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">Rebinned&#39;</span><span class="o">%</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">300</span><span class="p">):</span>
    <span class="n">CloneWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;100Rebinned&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">Clone&#39;</span><span class="o">%</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="n">SaveCSV</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;299Clone&#39;</span><span class="p">,</span> <span class="n">Filename</span><span class="o">=</span><span class="n">testing_directory</span> <span class="o">+</span> <span class="s1">&#39;Clone.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Wait a few seconds, then provoke a crash by executing the <cite>Segfault</cite> algorithm</p></li>
<li><p>Restart MantidWorkbench</p></li>
<li><p>You should be presented with the Project Recovery dialog</p></li>
<li><p>Choose <cite>Yes</cite></p></li>
<li><p>This should re-populate your workspace dialog and pop up a recovery script in the script window</p></li>
<li><p>Run the following script:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">testing_directory</span><span class="o">=&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">test</span><span class="o">&gt;</span>
<span class="n">SaveCSV</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;299Clone&#39;</span><span class="p">,</span> <span class="n">Filename</span><span class="o">=</span><span class="n">testing_directory</span> <span class="o">+</span><span class="s1">&#39;Clone_r.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Compare the contents of <cite>Clone.csv</cite> and <cite>Clone_r.csv</cite>, they should be the same</p></li>
</ul>
<hr class="docutils" />
<ol class="arabic simple" start="3">
<li><p>Testing workspaces of different types</p></li>
</ol>
<ul class="simple">
<li><p>Open up MantidWorkbench</p></li>
<li><p>Run the following script:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">testing_directory</span><span class="o">=&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">test</span><span class="o">&gt;</span>
<span class="n">Load</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span> <span class="s1">&#39;TOPAZ_3132_event.nxs&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;TOPAZ_3132_event&#39;</span><span class="p">,</span> <span class="n">LoadMonitors</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">ConvertToMD</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;TOPAZ_3132_event&#39;</span><span class="p">,</span> <span class="n">QDimensions</span><span class="o">=</span><span class="s1">&#39;Q3D&#39;</span><span class="p">,</span> <span class="n">dEAnalysisMode</span><span class="o">=</span><span class="s1">&#39;Elastic&#39;</span><span class="p">,</span> <span class="n">Q3DFrames</span><span class="o">=</span><span class="s1">&#39;Q_sample&#39;</span><span class="p">,</span> <span class="n">LorentzCorrection</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;TOPAZ_3132_md&#39;</span><span class="p">,</span>\
<span class="n">MinValues</span><span class="o">=</span><span class="s1">&#39;-25,-25,-25&#39;</span><span class="p">,</span> <span class="n">MaxValues</span><span class="o">=</span><span class="s1">&#39;25,25,25&#39;</span><span class="p">,</span> <span class="n">SplitInto</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">SplitThreshold</span><span class="o">=</span><span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="n">MaxRecursionDepth</span><span class="o">=</span><span class="s1">&#39;13&#39;</span><span class="p">,</span> <span class="n">MinRecursionDepth</span><span class="o">=</span><span class="s1">&#39;7&#39;</span><span class="p">)</span>
<span class="n">DeleteWorkspace</span><span class="p">(</span><span class="s2">&quot;TOPAZ_3132_event&quot;</span><span class="p">)</span>
<span class="n">multi_d</span> <span class="o">=</span> <span class="n">RenameWorkspace</span><span class="p">(</span><span class="s1">&#39;TOPAZ_3132_md&#39;</span><span class="p">)</span>
<span class="n">peaks</span><span class="o">=</span><span class="n">FindPeaksMD</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;multi_d&#39;</span><span class="p">,</span> <span class="n">PeakDistanceThreshold</span><span class="o">=</span><span class="s1">&#39;0.37680&#39;</span><span class="p">,</span> <span class="n">MaxPeaks</span><span class="o">=</span><span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="n">DensityThresholdFactor</span><span class="o">=</span><span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;TOPAZ_3132_peaks&#39;</span><span class="p">)</span>

<span class="n">long1</span><span class="o">=</span><span class="n">CreateMDHistoWorkspace</span><span class="p">(</span><span class="n">Dimensionality</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">Extents</span><span class="o">=</span><span class="s1">&#39;-3,3,-10,10&#39;</span><span class="p">,</span> <span class="n">SignalInput</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">),</span> <span class="n">ErrorInput</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">),</span>\
                        <span class="n">NumberOfBins</span><span class="o">=</span><span class="s1">&#39;100,100&#39;</span><span class="p">,</span> <span class="n">Names</span><span class="o">=</span><span class="s1">&#39;Dim1,Dim2&#39;</span><span class="p">,</span> <span class="n">Units</span><span class="o">=</span><span class="s1">&#39;MomentumTransfer, EnergyTransfer&#39;</span><span class="p">)</span>

<span class="n">long2</span><span class="o">=</span><span class="n">CreateMDHistoWorkspace</span><span class="p">(</span><span class="n">Dimensionality</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">Extents</span><span class="o">=</span><span class="s1">&#39;-3, 3, -10, 10&#39;</span><span class="p">,</span> <span class="n">SignalInput</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span> <span class="n">ErrorInput</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>\
                        <span class="n">NumberOfBins</span><span class="o">=</span><span class="s1">&#39;100, 100&#39;</span><span class="p">,</span> <span class="n">Names</span><span class="o">=</span><span class="s1">&#39;Dim1, Dim2&#39;</span><span class="p">,</span> <span class="n">Units</span><span class="o">=</span><span class="s1">&#39;MomentumTransfer, EnergyTransfer&#39;</span><span class="p">)</span>
<span class="n">long3</span><span class="o">=</span><span class="n">long1</span><span class="o">+</span><span class="n">long2</span>
<span class="n">DeleteWorkspace</span><span class="p">(</span><span class="s2">&quot;long1&quot;</span><span class="p">)</span>
<span class="n">DeleteWorkspace</span><span class="p">(</span><span class="s2">&quot;long2&quot;</span><span class="p">)</span>
<span class="n">long4</span><span class="o">=</span><span class="n">long3</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="n">DeleteWorkspace</span><span class="p">(</span><span class="s2">&quot;long3&quot;</span><span class="p">)</span>
<span class="n">CloneWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;long4&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Clone&#39;</span><span class="p">)</span>
<span class="n">ConvertMDHistoToMatrixWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;Clone&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Clone_matrix&#39;</span><span class="p">)</span>
<span class="n">SaveCSV</span><span class="p">(</span><span class="s1">&#39;Clone_matrix&#39;</span> <span class="p">,</span> <span class="n">testing_directory</span> <span class="o">+</span> <span class="s1">&#39;/method_test.csv&#39;</span><span class="p">)</span>

<span class="n">DgsReduction</span><span class="p">(</span><span class="n">SampleInputFile</span><span class="o">=</span><span class="s1">&#39;MAR11001.raw&#39;</span><span class="p">,</span> <span class="n">IncidentEnergyGuess</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;ws&#39;</span><span class="p">)</span>
<span class="n">Rebin</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;ws&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;rebin&#39;</span><span class="p">,</span> <span class="n">Params</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>
<span class="n">Rebin</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;rebin&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;rebin&#39;</span><span class="p">,</span> <span class="n">Params</span><span class="o">=</span><span class="s1">&#39;0.6&#39;</span><span class="p">)</span>
<span class="n">Rebin</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;rebin&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;rebin&#39;</span><span class="p">,</span> <span class="n">Params</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">)</span>
<span class="n">Rebin</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;rebin&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;rebin&#39;</span><span class="p">,</span> <span class="n">Params</span><span class="o">=</span><span class="s1">&#39;0.8&#39;</span><span class="p">)</span>
<span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;rebin&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;renamed&#39;</span><span class="p">)</span>
<span class="n">SaveCSV</span><span class="p">(</span><span class="s1">&#39;renamed&#39;</span><span class="p">,</span> <span class="n">testing_directory</span> <span class="o">+</span> <span class="s1">&#39;/rebin_test.csv&#39;</span><span class="p">)</span>


<span class="n">long4</span> <span class="o">*=</span> <span class="mi">4</span>
<span class="n">long4</span> <span class="o">+=</span> <span class="mf">3.00</span>
<span class="n">ConvertMDHistoToMatrixWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;long4&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;long4_matrix&#39;</span><span class="p">)</span>
<span class="n">SaveCSV</span><span class="p">(</span><span class="s1">&#39;long4_matrix&#39;</span><span class="p">,</span> <span class="n">testing_directory</span> <span class="o">+</span> <span class="s1">&#39;/test_binary_operators.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Force a crash by executing the <cite>Segfault</cite> algorithm</p></li>
<li><p>Restart MantidWorkbench</p></li>
<li><p>You should be presented with the Project Recovery dialog</p></li>
<li><p>Choose <cite>Yes</cite></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">testing_directory</span><span class="o">=&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">test</span><span class="o">&gt;</span>
<span class="n">SaveCSV</span><span class="p">(</span><span class="s1">&#39;Clone_matrix&#39;</span> <span class="p">,</span> <span class="n">testing_directory</span> <span class="o">+</span> <span class="s1">&#39;/method_test_r.csv&#39;</span><span class="p">)</span>
<span class="n">SaveCSV</span><span class="p">(</span><span class="s1">&#39;long4_matrix&#39;</span><span class="p">,</span> <span class="n">testing_directory</span> <span class="o">+</span> <span class="s1">&#39;/test_binary_operators_r.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Compare the contents of <code class="docutils literal notranslate"><span class="pre">/test_binary_operators.csv</span></code> and <code class="docutils literal notranslate"><span class="pre">/test_binary_operators_r.csv</span></code>, they should be the same</p></li>
<li><p>Compare the contents of <code class="docutils literal notranslate"><span class="pre">/method_test.csv</span></code> and <code class="docutils literal notranslate"><span class="pre">/method_test_r.csv</span></code>, they should be the same</p></li>
</ul>
<hr class="docutils" />
<ol class="arabic simple" start="4">
<li><p>Recovering plots and windows</p></li>
</ol>
<ul class="simple">
<li><p>Open MantidWorkbench - make sure no other instances of MantidWorkbench are running</p></li>
<li><p>Run the large script from test 1</p></li>
<li><p>In the workspace window right-click the <code class="docutils literal notranslate"><span class="pre">Sequential3</span></code> workspace and choose <cite>Plot spectrum</cite></p></li>
<li><p>Choose <cite>Plot All</cite></p></li>
<li><p>In the workspace window right-click the <code class="docutils literal notranslate"><span class="pre">Sequential1</span></code> workspace and choose <cite>Plot spectrum</cite></p></li>
<li><p>Change Plot type from individual to <cite>Tiled</cite>, and again click <cite>Plot all</cite></p></li>
<li><p>In the workspace window right-click the <code class="docutils literal notranslate"><span class="pre">Rename2</span></code> workspace and select <cite>Show Data</cite></p></li>
<li><p>In the top toolbar, navigate to <code class="docutils literal notranslate"><span class="pre">Interfaces</span> <span class="pre">&gt;</span> <span class="pre">Reflectometry</span></code> and open the <code class="docutils literal notranslate"><span class="pre">ISIS</span> <span class="pre">Reflectometry</span></code> interface</p></li>
</ul>
<img alt="../../_images/reporter-test-4.png" src="../../_images/reporter-test-4.png" />
<ul class="simple">
<li><p>Force a crash by executing the <cite>Segfault</cite> algorithm</p></li>
<li><p>Restart MantidWorkbench</p></li>
<li><p>You should be presented with the Project Recovery dialog</p></li>
<li><p>Choose <cite>Yes</cite></p></li>
<li><p>Mantid should reload the workspaces and reopen plots and interfaces (including the show data interface).
You should see these all reappear in the main screen (they may have been reopened, but minimised).</p></li>
</ul>
<p><em>(Note at time of writing, only ISIS Reflectometry and Engineering Diffraction are supported by Project Save / Recovery)</em></p>
<hr class="docutils" />
<ol class="arabic simple" start="5">
<li><p>Test multiple instances of Mantid running</p></li>
</ol>
<ul class="simple">
<li><p>Launch 2 instances of MantidWorkbench</p></li>
<li><p>Run the script on the first instance:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">DataY</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">DataE</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">NSpec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Instance 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Run this script on the other instance:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">DataY</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">DataE</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">NSpec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Instance 2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Crash the first instance of Mantid with <cite>Segfault</cite></p></li>
<li><p>Do not exit the second instance of Mantid</p></li>
<li><p>Restart MantidWorkbench</p></li>
<li><p>You should be presented with a Project Recovery dialog, offering to attempt a recovery - choose <cite>Yes</cite></p></li>
<li><p><cite>Instance 1</cite> should appear in the workspace dialog</p></li>
</ul>
<hr class="docutils" />
<ol class="arabic simple" start="6">
<li><p>Opening script only</p></li>
</ol>
<ul class="simple">
<li><p>Open MantidWorkbench</p></li>
<li><p>Run the large script from test 1</p></li>
<li><p>In the workspace window right-click the <code class="docutils literal notranslate"><span class="pre">Sequential3</span></code> workspace and choose <cite>Plot spectrum</cite></p></li>
<li><p>Choose <cite>Plot All</cite></p></li>
<li><p>Force a crash by executing the <cite>Segfault</cite> algorithm</p></li>
<li><p>Restart MantidWorkbench</p></li>
<li><p>You should be presented with the Project Recovery dialog</p></li>
<li><p>Choose <code class="docutils literal notranslate"><span class="pre">Only</span> <span class="pre">open</span> <span class="pre">in</span> <span class="pre">script</span> <span class="pre">editor</span></code></p></li>
<li><p>Mantid should open the script editor, with a script named <cite>ordered_recovery.py</cite></p></li>
<li><p>Run this script, it should repopulate the workspaces dialog, but not open any figures</p></li>
</ul>
<hr class="docutils" />
<ol class="arabic simple" start="7">
<li><p>Not attempting recovery</p></li>
</ol>
<ul class="simple">
<li><p>Open MantidWorkbench</p></li>
<li><p>Run the second script from test 1</p></li>
<li><p>In the workspace window right-click the <code class="docutils literal notranslate"><span class="pre">Sequential3</span></code> workspace and choose <cite>Plot spectrum</cite></p></li>
<li><p>Choose <cite>Plot All</cite></p></li>
<li><p>Force a crash by executing the <cite>Segfault</cite> algorithm</p></li>
<li><p>Restart MantidWorkbench</p></li>
<li><p>You should be presented with the Project Recovery dialog</p></li>
<li><p>Choose <code class="docutils literal notranslate"><span class="pre">Start</span> <span class="pre">mantid</span> <span class="pre">normally</span></code></p></li>
<li><p>Mantid should open as normal</p></li>
<li><p>With the Messages box at Debug level you should see the project saver starting up again</p></li>
</ul>
<hr class="docutils" />
<ol class="arabic simple" start="8">
<li><p>Check old history is purged</p></li>
</ol>
<ul class="simple">
<li><p>Open MantidWorkbench</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">DataY</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">DataE</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">NSpec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;NewWorkspace&#39;</span><span class="p">)</span>
<span class="n">RenameWorkspace</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;NewWorkspace&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Rename2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Save the workspace as a <cite>.nxs</cite> file, by highlighting the <code class="docutils literal notranslate"><span class="pre">Rename2</span></code> workspace and selecting
<code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">&gt;</span> <span class="pre">Nexus</span></code> at the top of the Workspaces toolbox.</p></li>
<li><p>Close Mantid normally</p></li>
<li><p>Restart MantidWorkbench</p></li>
<li><p>Re-open the workspace from the saved <cite>.nxs</cite> file</p></li>
<li><p>Wait for saving</p></li>
<li><p>Force a crash by executing the <cite>Segfault</cite> algorithm</p></li>
<li><p>Restart MantidWorkbench</p></li>
<li><p>Choose <code class="docutils literal notranslate"><span class="pre">Only</span> <span class="pre">open</span> <span class="pre">in</span> <span class="pre">script</span> <span class="pre">editor</span></code></p></li>
<li><p>Mantid should open a script named <code class="docutils literal notranslate"><span class="pre">ordered_recovery.py</span></code> in the script editor</p></li>
<li><p>This should contain only the <code class="docutils literal notranslate"><span class="pre">Load</span></code> command and no previous history (to see full history, right-click on the
workspace and select <code class="docutils literal notranslate"><span class="pre">Show</span> <span class="pre">History</span></code>)</p></li>
</ul>
<p>Finally, test out a few ideas of your own. Note that some more niche aspects of plotting are not saved, such as 3D plots,
and Sliceviewer is also not supported by project save/recovery.</p>
<p><strong>Complete!</strong> Thank you for testing! Make sure to <strong>raise any issues</strong> you found on Github.</p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ErrorReporterTesting.html" title="Previous Chapter: Error Reporter Testing"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Error Reporte...</span>
    </a>
  </li>
  <li>
    <a href="../LiveData/LiveDataTests.html" title="Next Chapter: Live Data Testing"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Live Data Testing &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>