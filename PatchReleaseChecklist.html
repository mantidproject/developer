<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Patch Release Checklist</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=77160d70" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=48f0e2ba"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Technical Steering Committee" href="TSC.html" />
    <link rel="prev" title="Release Checklist" href="ReleaseChecklist.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>master</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="index.html">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">User Documentation</a></li>
                <li><a href="http://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
<div class="related" role="navigation" aria-label="related navigation">
  <h3>Navigation</h3>
  <ul>
    <li class="nav-item nav-item-0"><a href="index.html">Documentation</a> &#187;</li>
    
    
    
    
    <li class="nav-item nav-item-this"><a href="">Patch Release Checklist</a></li>
    
    
  </ul>
</div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="patch-release-checklist">
<span id="patchreleasechecklist"></span><h1>Patch Release Checklist<a class="headerlink" href="#patch-release-checklist" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#request" id="id4">Request</a></p></li>
<li><p><a class="reference internal" href="#authorisation" id="id5">Authorisation</a></p></li>
<li><p><a class="reference internal" href="#development" id="id6">Development</a></p></li>
<li><p><a class="reference internal" href="#release-branch" id="id7">Release Branch</a></p>
<ul>
<li><p><a class="reference internal" href="#release-notes" id="id8">Release Notes</a></p></li>
<li><p><a class="reference internal" href="#cherry-picking-code-review" id="id9">Cherry Picking &amp; Code Review</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#nightly-builds" id="id10">Nightly Builds</a></p></li>
<li><p><a class="reference internal" href="#release-day" id="id11">Release Day</a></p></li>
</ul>
</nav>
<p>These are the steps involved in performing a Mantid patch release. To
perform a full release look see <a class="reference internal" href="ReleaseChecklist.html#releasechecklist"><span class="std std-ref">Release Checklist</span></a>.</p>
<section id="request">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Request</a><a class="headerlink" href="#request" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Anyone may request a patch release, but that request must be intially
approved by one of the local PMs.</p></li>
</ul>
</section>
<section id="authorisation">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Authorisation</a><a class="headerlink" href="#authorisation" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>The Project Management Team must meet to authorise the patch
release.</p></li>
<li><p>During the meeting other high value, low impact changes may be
considered for inclusion for the release. Any that are to be included
must be added to the patch release notes.</p></li>
<li><p>The Project Manager will create a new milestone in github, and all
tickets to be included must be moved to that milestone.</p></li>
<li><p>A developer will be nominated to be the main reviewer and compiler of
the patch.</p></li>
</ul>
</section>
<section id="development">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Development</a><a class="headerlink" href="#development" title="Permalink to this heading">¶</a></h2>
<p>The patch release will be prepared based off the tag used to mark
the last minor release. A branch called <code class="docutils literal notranslate"><span class="pre">release-next</span></code> will be created from this tag.
Changes for the patch should be made using the standard GitHub
workflow for merging code with <code class="docutils literal notranslate"><span class="pre">main</span></code>. The issue and pull request should then have the <code class="docutils literal notranslate"><span class="pre">PatchCandidate</span></code> label applied to them. These
commits will then be cherry picked from <code class="docutils literal notranslate"><span class="pre">main</span></code> on to the release branch.</p>
</section>
<section id="release-branch">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Release Branch</a><a class="headerlink" href="#release-branch" title="Permalink to this heading">¶</a></h2>
<p>The release branch will currently have its version fixed to exact
version of the last major/patch release. It is not a requirement but
advised to unfix the patch number while the patch is being compiled.
This prevents the nightly builds from generating a collection of packages that have
exactly the same version. The patch number can be unfixed by commenting the line in
<a class="reference external" href="https://www.github.com/mantidproject/mantid/blob/release-next/buildconfig/CMake/VersionNumber.cmake#L9">https://www.github.com/mantidproject/mantid/blob/release-next/buildconfig/CMake/VersionNumber.cmake#L9</a>.</p>
<section id="release-notes">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Release Notes</a><a class="headerlink" href="#release-notes" title="Permalink to this heading">¶</a></h3>
<p>Once the patch version has been unfixed the main reviewer should
create a skeleton set of patch release notes on the release branch
using the <a class="reference external" href="https://www.github.com/mantidproject/mantid/blob/main/tools/release_generator/patch.py">python helper tool</a>.</p>
</section>
<section id="cherry-picking-code-review">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Cherry Picking &amp; Code Review</a><a class="headerlink" href="#cherry-picking-code-review" title="Permalink to this heading">¶</a></h3>
<p>It is the job of the main reviewer of the release to review each
issue/pull request marked <code class="docutils literal notranslate"><span class="pre">PatchCandiate</span></code> and decide if the risks of
the changes are low enough to include in a release that will not
undergo full beta testing by scientists. If it is acceptable then on the release branch for each pull request:</p>
<ul class="simple">
<li><p>find the list of commit <code class="docutils literal notranslate"><span class="pre">SHA1</span></code> values in that pull request</p></li>
<li><p>check if any of these commits has altered the release notes for the
next major release</p></li>
<li><p>if not then pass all commits in the order oldest-&gt;newest to
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">-x</span></code></p></li>
<li><p>if release notes were modified in a commit on their own then pass all
commits except this one in the order oldest-&gt;newest to
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">-x</span></code></p></li>
<li><p>if a commit has a mixture of code/release note changes then:</p>
<ul>
<li><p>pass the list of commits up to but not including this commit to
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">-x</span></code></p></li>
<li><p>now pass this single commit to <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">-x</span> <span class="pre">-n</span></code> and it
will not make a commit. Remove the major release note changes and
commit <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>/<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code></p></li>
<li><p>if there are any remaining commits after this then pass them to
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">-x</span></code> as before.</p></li>
</ul>
</li>
<li><p>finally add a commit that updates the patch release notes with this
pull request link and description in the table.</p></li>
</ul>
<p>Once cherry picked the milestone of the original pull request should be
updated to the patch milestone.</p>
</section>
</section>
<section id="nightly-builds">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Nightly Builds</a><a class="headerlink" href="#nightly-builds" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference external" href="release-pipeline">release pipeline</a> contains jobs
that check for changes on the current release branch each night (00:00 GMT).
Any detected changes will cause a clean build of the code followed by a run
of the system tests. The Linux clean builds should have the <cite>PACKAGE_SUFFIX</cite> set
to <cite>nightly</cite> while testing the patch.</p>
<p>These jobs should be checked each morning to confirm that everything is green.</p>
</section>
<section id="release-day">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Release Day</a><a class="headerlink" href="#release-day" title="Permalink to this heading">¶</a></h2>
<p>On the day of release a few steps are required:</p>
<ul class="simple">
<li><p>update the patch version:</p></li>
<li><p>navigate to
<a class="reference external" href="https://www.github.com/mantidproject/mantid/blob/release-next/buildconfig/CMake/VersionNumber.cmake">https://www.github.com/mantidproject/mantid/blob/release-next/buildconfig/CMake/VersionNumber.cmake</a></p></li>
<li><p>edit the <code class="docutils literal notranslate"><span class="pre">VERSION_PATCH</span></code> to the required number for the patch and
commit the result</p></li>
<li><p>run a manual build of all of the OS jobs under {{
site.mantidreleasebuilds }} and when asked for a suffix use an empty
string</p></li>
<li><p>wait for the builds to finish (will take more than 1 cup of
tea/coffee/beverage of choice)</p></li>
</ul>
<p>While waiting for the builds create a new release on GitHub, using a tag
of the form <code class="docutils literal notranslate"><span class="pre">v.X.Y.Z</span></code> and populate with information from the release
notes (see a previous version of the format).</p>
<p>Once the builds complete have the development team run unscripted
testing on the packages generated by the clean release builds. In
particular the issues intended to be fixed should be tested.</p>
<p>Once the testing has passed:</p>
<ul class="simple">
<li><p>Use the manual deploy job at <a class="reference external" href="release-pipeline">release pipeline</a> to deploy
packages and documentation to the public web.</p></li>
<li><p>The windows binary will <strong>not</strong> be deployed and must be signed by
someone at ISIS and uploaded to sourceforge manually</p></li>
<li><p>Put packages on GitHub</p></li>
<li><p>RHEL 7 only: Build the suffix-package <code class="docutils literal notranslate"><span class="pre">mantidXY</span></code> by running another
clean RHEL 7 build from the <a class="reference external" href="release-pipeline">release pipeline</a> but use the
suffix XY, where <code class="docutils literal notranslate"><span class="pre">X</span></code> is the major version and <code class="docutils literal notranslate"><span class="pre">Y</span></code> is the minor
version (currently used at SNS)</p></li>
<li><p>Create new DOI using the scripts in the codebase and instructions on
<a class="reference internal" href="ReleaseChecklist.html#releasechecklist"><span class="std std-ref">release checklist</span></a>.</p></li>
<li><p>Open a PR to update the relevant metadata in the <code class="docutils literal notranslate"><span class="pre">CITATION.cff</span></code> file as
explained in the <a class="reference internal" href="ReleaseChecklist.html#releasechecklist"><span class="std std-ref">release checklist</span></a>.</p></li>
<li><p>Send an email, including the text of the release notes, to the
following lists</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nobugs&#64;nobugsconference.org</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">news&#64;neutronsources.org</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neutron&#64;neutronsources.org</span></code></p></li>
<li><p>Also post the contents of the message on Announcements on Slack</p></li>
<li><p>Add topic to the news page on the <a class="reference external" href="http://forum.mantidproject.org/">forum</a></p></li>
<li><p>Close the release milestone in github</p></li>
<li><p>Remove the patch candidate tag from pull requests (if not already done)</p></li>
</ul>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ReleaseChecklist.html" title="Previous Chapter: Release Checklist"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Release Checklist</span>
    </a>
  </li>
  <li>
    <a href="TSC.html" title="Next Chapter: Technical Steering Committee"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Technical Ste... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>