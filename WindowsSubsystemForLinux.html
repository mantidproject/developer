<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Windows Subsystem for Linux (WSL2)</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=77160d70" />
    <script src="_static/documentation_options.js?v=30d551ce"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Obtaining a Benchmark for Mantid Fitting" href="ObtainingABenchmarkForMantidFitting.html" />
    <link rel="prev" title="Eclipse on Ubuntu" href="Eclipse.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>master</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="index.html">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">User Documentation</a></li>
                <li><a href="http://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
<div class="related" role="navigation" aria-label="related navigation">
  <h3>Navigation</h3>
  <ul>
    <li class="nav-item nav-item-0"><a href="index.html">Documentation</a> &#187;</li>
    
    
    
    
    <li class="nav-item nav-item-this"><a href="">Windows Subsystem for Linux (WSL2)</a></li>
    
    
  </ul>
</div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="windows-subsystem-for-linux-wsl2">
<span id="windowssubsystemforlinux"></span><h1>Windows Subsystem for Linux (WSL2)<a class="headerlink" href="#windows-subsystem-for-linux-wsl2" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#initial-setup" id="id1">Initial Setup</a></p></li>
<li><p><a class="reference internal" href="#install-a-ubuntu-18-04-subsystem" id="id2">Install a Ubuntu-18.04 Subsystem</a></p></li>
<li><p><a class="reference internal" href="#install-a-centos7-subsystem" id="id3">Install a Centos7 Subsystem</a></p></li>
<li><p><a class="reference internal" href="#running-a-linux-subsystem" id="id4">Running a Linux Subsystem</a></p></li>
<li><p><a class="reference internal" href="#cloning-mantid" id="id5">Cloning Mantid</a></p></li>
<li><p><a class="reference internal" href="#using-graphical-user-interfaces-gui" id="id6">Using Graphical User Interfaces (GUI)</a></p></li>
<li><p><a class="reference internal" href="#tips" id="id7">Tips</a></p></li>
</ul>
</nav>
<p>The Windows Subsystem for Linux lets developers run a Linux environment directly on Windows, unmodified, without the overhead of a traditional virtual machine or dualboot setup.</p>
<section id="initial-setup">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Initial Setup</a><a class="headerlink" href="#initial-setup" title="Link to this heading">¶</a></h2>
<p>Some initial setup is required on your Windows system before the Linux environment of your choice can be installed. Before you start this process make sure you have the latest version of Windows 10.</p>
<ol class="arabic simple">
<li><p>Install <a class="reference external" href="https://hub.docker.com/editions/community/docker-ce-desktop-windows">Docker Desktop for Windows</a>. This will install WSL2 for you, and also enables us to get a centos7 image later on.</p></li>
<li><p>In the Windows Start menu open <cite>Turn Windows features on or off</cite>.</p></li>
<li><p>Make sure <cite>Windows System for Linux</cite> and <cite>Virtual Machine Platform</cite> are ticked. Click OK.</p></li>
</ol>
<p>If you now open a File Explorer and go to the <cite>\\wsl$</cite> directory. This will be the location of your linux subsystem.</p>
</section>
<section id="install-a-ubuntu-18-04-subsystem">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Install a Ubuntu-18.04 Subsystem</a><a class="headerlink" href="#install-a-ubuntu-18-04-subsystem" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Go to the Microsoft Store and install Ubuntu 18.04. Notice that a new <cite>Ubuntu-18.04</cite> directory has appeared in the <cite>\\wsl$</cite> location. This is your Ubuntu 18.04 subsystem.</p></li>
<li><p>In the Windows Start menu type Ubuntu 18.04 to open its terminal. If it says you are missing a package then follow the link provided to install this package.</p></li>
<li><p>Enter a username and password in the terminal when prompted.</p></li>
</ol>
<p>You are now in an Ubuntu 18.04 terminal. Any files in the <cite>\\wsl$\Ubuntu-18.04\home\&lt;user name&gt;</cite> directory will appear in this Ubuntu environment.</p>
</section>
<section id="install-a-centos7-subsystem">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Install a Centos7 Subsystem</a><a class="headerlink" href="#install-a-centos7-subsystem" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Open the Windows command prompt and run the follow to get the latest centos7 image</p></li>
</ol>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>image<span class="w"> </span>pull<span class="w"> </span>centos:centos7
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Then make a <cite>*.tar</cite> file from this image, where <cite>998e</cite> is the first four characters of the text outputted by the <cite>docker create</cite> command.</p></li>
</ol>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>create<span class="w"> </span>-i<span class="w"> </span>centos:centos7<span class="w"> </span>bash

docker<span class="w"> </span><span class="nb">export</span><span class="w"> </span>998e<span class="w"> </span>&gt;<span class="w"> </span>centos7.tar
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Finally import the file to the wsl directory:</p></li>
</ol>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>wsl<span class="w"> </span>--import<span class="w"> </span>Centos7<span class="w"> </span>.<span class="se">\C</span>entosImage<span class="se">\ </span>centos7.tar
</pre></div>
</div>
<p>Notice that a new <cite>Centos7</cite> directory has appeared in the <cite>\\wsl$</cite> location. Any files in the <cite>\\wsl$\Centos7\root</cite> directory will appear in this Centos7 environment.</p>
</section>
<section id="running-a-linux-subsystem">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Running a Linux Subsystem</a><a class="headerlink" href="#running-a-linux-subsystem" title="Link to this heading">¶</a></h2>
<p>You can run either of these linux subsystems from the Windows command prompt using</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>wsl<span class="w"> </span>-d<span class="w"> </span><span class="o">[</span>OS<span class="o">]</span>
</pre></div>
</div>
<p>where [OS] is replaced by <cite>Ubuntu-18.04</cite> or <cite>Centos7</cite>.</p>
</section>
<section id="cloning-mantid">
<span id="wsl-cloning-mantid-ref"></span><h2><a class="toc-backref" href="#id5" role="doc-backlink">Cloning Mantid</a><a class="headerlink" href="#cloning-mantid" title="Link to this heading">¶</a></h2>
<p>Before you clone Mantid code, follow the <a class="reference internal" href="GettingStarted/GettingStarted.html#gettingstarted"><span class="std std-ref">getting started</span></a> instructions to install all of the required dependencies for your linux environment.</p>
<p>The Mantid code can then be retrieved in the usual way using <cite>git clone</cite> from the Ubuntu or Centos7 terminal. The first time you do this you might need to set up an <a class="reference external" href="https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh">ssh key</a> for authentication.</p>
<p>You are now ready to CMake and build the Mantid code. Follow the Ubuntu 18.04 or Centos 7 build instructions <a class="reference external" href="https://developer.mantidproject.org/GettingStarted.html#linux">here</a>.</p>
</section>
<section id="using-graphical-user-interfaces-gui">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Using Graphical User Interfaces (GUI)</a><a class="headerlink" href="#using-graphical-user-interfaces-gui" title="Link to this heading">¶</a></h2>
<p>WSL does not currently support GUIs. In order to display a GUI from an application running in WSL you will need to use an XServer. Failure to do so will result in a crash upon launching <cite>workbench</cite>.</p>
<p>To use an XServer:</p>
<ol class="arabic simple">
<li><p>Download a compatible XServer onto the host Windows machine. <a class="reference external" href="https://mobaxterm.mobatek.net/">MobaXterm</a> is recommended and has been confirmed to work with Mantid Workbench.</p></li>
<li><p>Install <cite>MobaXterm</cite> and open the MobaXterm app upon completion. Using the <cite>Settings</cite> drop down menu select <cite>Configure</cite>. On the <cite>X11</cite> tab ensure that <cite>X11 server display mode</cite> is set to
<cite>Multiwindow mode</cite> and that <cite>X11 remote access</cite> is set to <cite>full</cite>.</p></li>
<li><p>The XServer should be running by default - this can be checked by clicking the <cite>X server</cite> icon in the top right hand corner of the <cite>MobaXterm</cite> interface.</p></li>
<li><p>Configure the <cite>DISPLAY</cite> variable on WSL. The manner in which this is done differs between WSL1 and WSL2. To check which version you have use the command <cite>wsl -l -v</cite> in the command prompt on the host machine.
If you have WSL1, it is recommended to upgrade to <a class="reference external" href="https://learn.microsoft.com/en-us/windows/wsl/install">WSL2</a>.</p></li>
</ol>
<blockquote>
<div><ol class="arabic">
<li><p>On WSL, use <cite>cd</cite> to navigate to your home directory containing the <cite>.bashrc</cite> file.</p></li>
<li><p>Using <cite>vi .bashrc</cite> append the following to the file contents:</p>
<p><cite>export DISPLAY=$(route.exe print | grep 0.0.0.0 | head -1 | awk ‘{print $4}’):0.0</cite>.</p>
</li>
<li><p>Exit and re-enter WSL via the command prompt.</p></li>
<li><p>Echo the <cite>DISPLAY</cite> variable, you should see the value <cite>&lt;host machine IP Address&gt;:0.0</cite>. You can compare this output IP address to that output when running <cite>ipconfig /all</cite> through the command line on the host machine.</p></li>
</ol>
</div></blockquote>
</section>
<section id="tips">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Tips</a><a class="headerlink" href="#tips" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Make sure you install <a class="reference external" href="https://developer.mantidproject.org/BuildingWithCMake.html#from-the-command-line">devtoolset-7</a> for Centos 7 as described in the provided link before CMake and build.</p></li>
<li><p>It might also be necessary to install some addition packages for Ubuntu 18.04, including <cite>libnexus0-dev</cite>.</p></li>
</ul>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="Eclipse.html" title="Previous Chapter: Eclipse on Ubuntu"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Eclipse on Ubuntu</span>
    </a>
  </li>
  <li>
    <a href="ObtainingABenchmarkForMantidFitting.html" title="Next Chapter: Obtaining a Benchmark for Mantid Fitting"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Obtaining a B... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>